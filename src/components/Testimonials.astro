---
import { Icon } from "astro-icon/components";

interface Testimonial {
    name: string;
    role: string;
    image: string;
    text: string;
}

const testimonials: Testimonial[] = [
    {
        name: "Sarah Jenkins",
        role: "Found a room in Indiranagar",
        image: "https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=150&h=150&fit=crop&crop=faces",
        text: "I was so stressed about moving to a new city, but RoomieMatch made it incredibly easy. I found a great apartment and an amazing roommate in just 3 days!",
    },
    {
        name: "Rahul Sharma",
        role: "Found a flatmate in Mumbai",
        image: "https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=150&h=150&fit=crop&crop=faces",
        text: "The compatibility matching is spot on. My roommate and I have the same schedule and habits. It feels like living with an old friend.",
    },
    {
        name: "Priya Patel",
        role: "Rented out spare room",
        image: "https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=faces",
        text: "As a host, safety was my main concern. The verification process gave me peace of mind, and I found a trusted tenant very quickly.",
    },
    {
        name: "David Cohen",
        role: "Resident in Bangalore",
        image: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=faces",
        text: "Great experience with RoomieMatch! The platform is intuitive and the community is genuinely helpful.",
    },
    {
        name: "Ananya Reddy",
        role: "Found a room in Hyderabad",
        image: "https://images.unsplash.com/photo-1524504388940-b1c1722653e1?w=150&h=150&fit=crop&crop=faces",
        text: "Moving to a new city was daunting, but finding a compatible roommate made all the difference. Highly recommend!",
    },
    {
        name: "Michael Chen",
        role: "Found a flatmate in Delhi",
        image: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=150&h=150&fit=crop&crop=faces",
        text: "The verification features are excellent. I knew my potential roommate was genuine before even meeting them.",
    },
];

// Split testimonials into three columns for the masonry effect
const column1 = testimonials.slice(0, 2);
const column2 = testimonials.slice(2, 4);
const column3 = testimonials.slice(4, 6);
---

<section class="testimonials section">
    <div class="container">
        <div class="section-header" data-animate="fade-up">
            <span class="badge badge-pink">Happy Community</span>
            <h2 class="section-title">What our members say</h2>
            <p class="section-subtitle">
                Join thousands of happy roommates who found their perfect match
            </p>
        </div>

        <div class="testimonials-columns">
            <!-- Column 1 - Scroll Up -->
            <div class="testimonials-column">
                <div class="testimonials-scroll scroll-up">
                    {
                        [...column1, ...column1, ...column1].map(
                            (testimonial) => (
                                <div class="testimonial-card">
                                    <div class="testimonial-text">
                                        {testimonial.text}
                                    </div>
                                    <div class="testimonial-author">
                                        <img
                                            src={testimonial.image}
                                            alt={testimonial.name}
                                            class="author-image"
                                            loading="lazy"
                                        />
                                        <div class="author-info">
                                            <div class="author-name">
                                                {testimonial.name}
                                            </div>
                                            <div class="author-role">
                                                {testimonial.role}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            ),
                        )
                    }
                </div>
            </div>

            <!-- Column 2 - Scroll Down -->
            <div class="testimonials-column">
                <div class="testimonials-scroll scroll-down">
                    {
                        [...column2, ...column2, ...column2].map(
                            (testimonial) => (
                                <div class="testimonial-card">
                                    <div class="testimonial-text">
                                        {testimonial.text}
                                    </div>
                                    <div class="testimonial-author">
                                        <img
                                            src={testimonial.image}
                                            alt={testimonial.name}
                                            class="author-image"
                                            loading="lazy"
                                        />
                                        <div class="author-info">
                                            <div class="author-name">
                                                {testimonial.name}
                                            </div>
                                            <div class="author-role">
                                                {testimonial.role}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            ),
                        )
                    }
                </div>
            </div>

            <!-- Column 3 - Scroll Up (slower) -->
            <div class="testimonials-column hide-on-mobile">
                <div class="testimonials-scroll scroll-up-slow">
                    {
                        [...column3, ...column3, ...column3].map(
                            (testimonial) => (
                                <div class="testimonial-card">
                                    <div class="testimonial-text">
                                        {testimonial.text}
                                    </div>
                                    <div class="testimonial-author">
                                        <img
                                            src={testimonial.image}
                                            alt={testimonial.name}
                                            class="author-image"
                                            loading="lazy"
                                        />
                                        <div class="author-info">
                                            <div class="author-name">
                                                {testimonial.name}
                                            </div>
                                            <div class="author-role">
                                                {testimonial.role}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            ),
                        )
                    }
                </div>
            </div>
        </div>
    </div>
</section>

<style>
    .testimonials {
        padding: 100px 0;
        overflow: hidden;
        background: var(--color-white);
    }

    .testimonials-columns {
        display: flex;
        gap: 24px;
        height: 600px;
        overflow: hidden;
        mask-image: linear-gradient(
            to bottom,
            transparent,
            black 10%,
            black 90%,
            transparent
        );
        -webkit-mask-image: linear-gradient(
            to bottom,
            transparent,
            black 10%,
            black 90%,
            transparent
        );
    }

    .testimonials-column {
        flex: 1;
        overflow: hidden;
    }

    .testimonials-scroll {
        display: flex;
        flex-direction: column;
        gap: 24px;
        padding-bottom: 24px;
    }

    /* Scroll Up Animation */
    .scroll-up {
        animation: scrollUp 20s linear infinite;
    }

    /* Scroll Down Animation */
    .scroll-down {
        animation: scrollDown 25s linear infinite;
    }

    /* Scroll Up Slow Animation */
    .scroll-up-slow {
        animation: scrollUp 30s linear infinite;
    }

    @keyframes scrollUp {
        0% {
            transform: translateY(0);
        }
        100% {
            transform: translateY(calc(-100% / 3));
        }
    }

    @keyframes scrollDown {
        0% {
            transform: translateY(calc(-100% / 3));
        }
        100% {
            transform: translateY(0);
        }
    }

    /* Pause animation on hover */
    .testimonials-columns:hover .testimonials-scroll {
        animation-play-state: paused;
    }

    /* Testimonial Card */
    .testimonial-card {
        background: var(--color-white);
        padding: 28px;
        border-radius: var(--radius-xl);
        border: 1px solid rgba(255, 90, 95, 0.08);
        box-shadow: 0 4px 20px rgba(255, 90, 95, 0.06);
        transition: all 0.3s var(--ease-out);
        position: relative;
        overflow: hidden;
    }

    /* Glowing pink corners */
    .testimonial-card::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 100%;
        height: 100%;
        background: radial-gradient(
            circle at center,
            rgba(255, 90, 95, 0.15) 0%,
            transparent 70%
        );
        pointer-events: none;
        transition: opacity 0.3s ease;
    }

    .testimonial-card::after {
        content: "";
        position: absolute;
        bottom: -50%;
        right: -50%;
        width: 100%;
        height: 100%;
        background: radial-gradient(
            circle at center,
            rgba(255, 143, 148, 0.12) 0%,
            transparent 70%
        );
        pointer-events: none;
        transition: opacity 0.3s ease;
    }

    .testimonial-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 12px 32px rgba(255, 90, 95, 0.12);
        border-color: rgba(255, 90, 95, 0.15);
    }

    .testimonial-card:hover::before,
    .testimonial-card:hover::after {
        opacity: 1.5;
    }

    .testimonial-text {
        font-size: 15px;
        line-height: 1.7;
        color: var(--text-primary);
        margin-bottom: 20px;
    }

    .testimonial-author {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .author-image {
        width: 44px;
        height: 44px;
        border-radius: 50%;
        object-fit: cover;
        border: 2px solid var(--color-pink-soft);
    }

    .author-info {
        display: flex;
        flex-direction: column;
    }

    .author-name {
        font-family: var(--font-display);
        font-size: 14px;
        font-weight: 600;
        color: var(--text-primary);
        line-height: 1.3;
    }

    .author-role {
        font-size: 13px;
        color: var(--text-muted);
        line-height: 1.3;
    }

    /* Responsive */
    @media (max-width: 1024px) {
        .hide-on-mobile {
            display: none;
        }

        .testimonials-columns {
            height: 500px;
        }
    }

    @media (max-width: 768px) {
        .testimonials {
            padding: 80px 0;
        }

        .testimonials-columns {
            flex-direction: column;
            height: auto;
            max-height: 600px;
            gap: 16px;
        }

        .testimonials-column {
            display: none;
        }

        .testimonials-column:first-child {
            display: block;
        }

        .testimonial-card {
            padding: 20px;
        }

        .testimonial-text {
            font-size: 14px;
        }
    }
</style>
